Bootstrap: docker
From: ubuntu

%runscript
  cd /opt/JonesEtAl2009/
  nrnivmodl mod_files
  mpirun -n `nproc` nrniv -mpi Batch.hoc

%post
  # Openmpi
  apt-get update
  apt-get install wget openssh-client python3 lsof -y
  apt-get install libcr-dev -y
  apt-get install build-essential -y
  wget https://download.open-mpi.org/release/open-mpi/v3.1/openmpi-3.1.4.tar.gz
  gunzip -c openmpi-3.1.4.tar.gz | tar xf -
  cd openmpi-3.1.4/
  ./configure --prefix=/usr/local
  make all install

  # Neuron
  apt-get install libx11-dev -y
  apt-get install libreadline-dev libreadline5 -y
  apt-get install libncurses5-dev libncursesw5-dev -y
  wget https://neuron.yale.edu/ftp/neuron/versions/v7.7/nrn-7.7.x86_64-linux.deb
  dpkg -i nrn-7.7.x86_64-linux.deb

%files
 JonesEtAl2009/ /opt
